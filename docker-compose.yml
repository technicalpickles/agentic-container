services:
  dev:
    build:
      context: .
      dockerfile: Dockerfile
      target: standard
    volumes:
      - .:/workspace
      # Mount Docker socket for Docker-in-Docker
      # Option 1: Let Colima handle the magic (current working approach)
      - /var/run/docker.sock:/var/run/docker.sock
      # Option 2: Direct path to Colima socket (more explicit)
      # - /Users/josh.nichols/.colima/gusto/docker.sock:/var/run/docker.sock
    working_dir: /workspace
    command: ["/bin/bash", "--login"]
    tty: true
    stdin_open: true
    # Enable privileged mode for Docker-in-Docker (can be removed if not needed)
    privileged: true
    # Use non-root user for devcontainer compatibility
    user: "1001:1001"
